---
title: ""
author: ""
date:
output:
  github_document
---

```{r setup}
library(tidyverse)
library(modelr)

```

```{r }
diamonds %>%
  ggplot(aes(cut, price)) +
  geom_boxplot()
```

A naive view of the data implies that `cut` negatively effects `price`.

```{r }
fit <-
  lm(
    formula = price ~ carat + color + clarity,
    data = diamonds
  )

diamonds %>%
  add_predictions(fit, var = "price_pred") %>%
  mutate(resid_cut = price - price_pred) %>%

  ggplot(aes(cut, resid_cut)) +
  geom_boxplot()
```



```{r }
diamonds %>%
  ggplot(aes(carat, price, color = cut)) +
  geom_point() +
  geom_smooth() +
  scale_x_log10() +
  scale_y_log10()
```
